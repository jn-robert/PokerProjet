<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Chat poker</title>
    <style>
        #zone_chat strong {
            color: white;
            background-color: red;
            padding: 2px;
        }
    </style>
</head>

<body>
<h1 style="text-align: center">PokerChat</h1>

<form action="/" method="post" id="formulaire_chat">
    <input type="text" name="message" id="message" placeholder="Une mauvaise pioche faite le savoir" size="50" autofocus />
    <input type="submit" id="envoi_message" value="Send" />
</form>

<section id="zone_chat">
<!--endroit ou les messages apparaissent-->
</section>


<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>

    // connection
    var socket = io.connect('http://localhost:8080');

    // demande le pseudo de l'utilisateur
    //limitaton de l'ajout
    var pseudo = prompt('Pour parler il vous faut un nom ?');
    socket.emit('nouveau_client', pseudo);
    document.title = pseudo + ' - ' + document.title;

    //affichage suite a reception
    socket.on('message', function(data) {
        insereMessage(data.pseudo, data.message)
    })



    //information de connection d'un nouveau membre
    socket.on('nouveau_client', function(pseudo) {
        $('#zone_chat').prepend('<p><em>' + pseudo + ' a rejoint la conversation</em></p>');
    })




    //partie qui ajoute le message dans la zone de chat
    $('#formulaire_chat').submit(function () {
        var message = $('#message').val(); //cf doc socket.io
        socket.emit('message', message);
        insereMessage(pseudo, message);
        $('#message').val('').focus();
        return false;
    });


    //partie qui ajoute le message dans la zone de chat
    function insereMessage(pseudo, message) {
        $('#zone_chat').prepend('<p><strong>' + pseudo + '</strong> ' + message + '</p>');
    }
</script>
</body>
</html>